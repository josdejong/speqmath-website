<html>
<head>
<title>example4e.iba</title>
</head>
<!-- Generated by SynEdit HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  size="3" face="Courier New"><font color="#0000FF">SUB </font>evalLine<font color="#000080">(</font>expression<font color="#000080">:</font><font color="#FF0000">STRING</font><font color="#000080">), </font><font color="#FF0000">STRING
    </font><font color="#008000"><b><i>'this sub evaluates the expression and returns a string that
</i></b>    <b><i>'can contain the answer or an (error) message. The expression
</i></b>    <b><i>'may contain values, operators + - * / ^ E and parentheses ( )
</i></b>    </font><font color="#FF0000">DOUBLE </font>ans
    MESSAGE msg

    <font color="#008000"><b><i>'make the error message empty (ready for use)
</i></b>    </font>errClear<font color="#000080">(</font>msg<font color="#000080">)

    </font><font color="#008000"><b><i>'evaluate the expression
</i></b>    </font>ans <font color="#000080">= </font>eval<font color="#000080">(</font>expression<font color="#000080">, </font>msg<font color="#000080">)

    </font><font color="#008000"><b><i>'return (error) message if not empty
</i></b>    </font><font color="#0000FF">IF </font>msg<font color="#000080">.</font>t<font color="#000080">&lt;&gt;</font>MSG_EMPTY <font color="#0000FF">THEN RETURN </font>msg<font color="#000080">.</font>desc

    <font color="#008000"><b><i>'if no error occured, return the answer
</i></b>    </font><font color="#0000FF">RETURN </font><font color="#800080">&quot;Ans = &quot; </font><font color="#000080">+ </font><font color="#0000FF">USING</font><font color="#000080">(</font><font color="#800080">&quot;#.#####&quot;</font><font color="#000080">, </font>ans<font color="#000080">)
</font><font color="#0000FF">ENDSUB
</font></font>
</code></pre>
</body>
</html>