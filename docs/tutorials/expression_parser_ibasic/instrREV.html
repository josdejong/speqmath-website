<html>
<head>
<title>instrREV.iba</title>
</head>
<!-- Generated by SynEdit HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  size="3" face="Courier New"><font color="#0000FF">SUB </font>InstrREV<font color="#000080">(</font>expr<font color="#000080">:</font><font color="#FF0000">STRING</font><font color="#000080">, </font>search<font color="#000080">:</font><font color="#FF0000">STRING</font><font color="#000080">, </font>posmax<font color="#000080">:</font><font color="#FF0000">INT</font><font color="#000080">), </font><font color="#FF0000">INT
    </font><font color="#008000"><b><i>'returns the position of the last string search in the string expr,
</i></b>    <b><i>' before position posmax
</i></b>    </font><font color="#FF0000">INT </font>n<font color="#000080">, </font>p
    p<font color="#000080">=</font><b>0</b>	<font color="#000080">:</font>n<font color="#000080">=</font><b>0
</b>    <font color="#0000FF">DO
        </font>p <font color="#000080">= </font><font color="#0000FF">INSTR</font><font color="#000080">(</font>expr<font color="#000080">, </font>search<font color="#000080">, </font>p<font color="#000080">+</font><b>1</b><font color="#000080">)
        </font>p <font color="#000080">= </font>p<font color="#000080">*(</font>p<font color="#000080">&lt;=</font>posmax<font color="#000080">)
        </font><font color="#0000FF">IF </font>p<font color="#000080">&gt;</font><b>0</b> <font color="#0000FF">THEN </font>n<font color="#000080">=</font>p
    <font color="#0000FF">UNTIL </font>p<font color="#000080">=</font><b>0
</b>    
    <font color="#0000FF">RETURN </font>n
<font color="#0000FF">ENDSUB
</font></font>
</code></pre>
</body>
</html>