<html>
<head>
<title>isOperator.iba</title>
</head>
<!-- Generated by SynEdit HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  size="3" face="Courier New"><font color="#0000FF">SUB </font>isOperator<font color="#000080">(</font>expr<font color="#000080">:</font><font color="#FF0000">STRING</font><font color="#000080">, </font>op<font color="#000080">:</font><font color="#FF0000">CHAR</font><font color="#000080">, </font>n<font color="#000080">:</font><font color="#FF0000">INT</font><font color="#000080">), </font><font color="#FF0000">INT
    </font><font color="#008000"><b><i>'This sub checks of the operator at postion n in expr is a
</i></b>    <b><i>'legal operator. For example the &quot;+&quot; in &quot;2.3E+3&quot; is no operator,
</i></b>    <b><i>'and the &quot;-&quot; in &quot;3 * -2.5&quot; is no operator but a unary minus
</i></b>    </font><font color="#FF0000">STRING </font>sign
    
    <font color="#0000FF">IF </font>op<font color="#000080">=</font><font color="#800080">&quot;+&quot;
        </font><font color="#0000FF">IF UCASE$</font><font color="#000080">(</font><font color="#0000FF">MID$</font><font color="#000080">(</font>expr<font color="#000080">,</font>n<font color="#000080">-</font><b>1</b><font color="#000080">,</font><b>1</b><font color="#000080">))=</font><font color="#800080">&quot;E&quot;
            </font><font color="#0000FF">IF </font>n<font color="#000080">&gt;</font><b>2
</b>                <font color="#0000FF">IF INSTR</font><font color="#000080">(</font><font color="#800080">&quot;1234567890.&quot;</font><font color="#000080">, </font><font color="#0000FF">MID$</font><font color="#000080">(</font>expr<font color="#000080">,</font>n<font color="#000080">-</font><b>2</b><font color="#000080">,</font><b>1</b><font color="#000080">))&gt;</font><b>0
</b>                    <font color="#008000"><b><i>'for example &quot;2.52E+4&quot;
</i></b>                    </font><font color="#0000FF">RETURN </font><font color="#FF8000">FALSE
                </font><font color="#0000FF">ENDIF
            ENDIF
        ENDIF
        <font color="#0000FF">RETURN </font><font color="#FF8000">TRUE</font>
    ENDIF
    
    IF </font>op<font color="#000080">=</font><font color="#800080">&quot;-&quot;
        </font><font color="#0000FF">IF </font>n<font color="#000080">=</font><b>1
</b>            <font color="#008000"><b><i>'this is an unary minus, at the first position of the expr
</i></b>            <b><i>'for example &quot;-3.4 / 6&quot;
</i></b>            </font><font color="#0000FF">RETURN </font><font color="#FF8000">FALSE
        </font><font color="#0000FF">ELSE
            </font><font color="#008000"><b><i>'check for an unary minus (for example 2*-3  or  2.5E-6)
</i></b>            <b><i>'check the characters before the minus
</i></b>            </font>sign <font color="#000080">= </font><font color="#0000FF">LEFT$</font><font color="#000080">(</font>expr<font color="#000080">,</font>n<font color="#000080">-</font><b>1</b><font color="#000080">)
            </font>sign <font color="#000080">= </font><font color="#0000FF">RIGHT$</font><font color="#000080">(</font><font color="#0000FF">RTRIM$</font><font color="#000080">(</font>sign<font color="#000080">),</font><b>1</b><font color="#000080">)
            </font><font color="#0000FF">IF INSTR</font><font color="#000080">(</font><font color="#800080">&quot;+-/*^&quot;</font><font color="#000080">, </font>sign<font color="#000080">)&gt;</font><b>0
</b>                <font color="#008000"><b><i>'For example &quot;3.5 * -2&quot;
</i></b>                </font><font color="#0000FF">RETURN </font><font color="#FF8000">FALSE
            </font><font color="#0000FF">ENDIF
            IF UCASE$</font><font color="#000080">(</font><font color="#0000FF">MID$</font><font color="#000080">(</font>expr<font color="#000080">,</font>n<font color="#000080">-</font><b>1</b><font color="#000080">,</font><b>1</b><font color="#000080">))=</font><font color="#800080">&quot;E&quot; </font><font color="#0000FF">AND </font>n<font color="#000080">&gt;</font><b>2
</b>                <font color="#0000FF">IF INSTR</font><font color="#000080">(</font><font color="#800080">&quot;1234567890.&quot;</font><font color="#000080">, </font><font color="#0000FF">MID$</font><font color="#000080">(</font>expr<font color="#000080">,</font>n<font color="#000080">-</font><b>2</b><font color="#000080">,</font><b>1</b><font color="#000080">))&gt;</font><b>0
</b>                    <font color="#008000"><b><i>'for example &quot;2.3E-4&quot;
</i></b>                    </font><font color="#0000FF">RETURN </font><font color="#FF8000">FALSE
                </font><font color="#0000FF">ENDIF
            ENDIF
        ENDIF
        <font color="#0000FF">RETURN </font><font color="#FF8000">TRUE</font>
    ENDIF
    
    </font><font color="#008000"><b><i>'no problems found, the operator is indeed an operator.
</i></b>    </font><font color="#0000FF">RETURN </font><font color="#FF8000">TRUE
</font><font color="#0000FF">ENDSUB
</font></font>
</code></pre>
</body>
</html>
