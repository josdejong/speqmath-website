<html>
<head>
<title>example5b.iba</title>
</head>
<!-- Generated by SynEdit HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  size="3" face="Courier New"><font color="#008000"><b><i>'check if the expression is a function, like &quot;Sin(2+3)&quot;
</i></b></font>pos <font color="#000080">= </font><font color="#0000FF">INSTR</font><font color="#000080">(</font>expr<font color="#000080">,</font><font color="#800080">&quot;(&quot;</font><font color="#000080">)
</font><font color="#0000FF">IF </font>pos<font color="#000080">&gt;</font><b>0</b> <font color="#0000FF">AND RIGHT$</font><font color="#000080">(</font>expr<font color="#000080">,</font><b>1</b><font color="#000080">)=</font><font color="#800080">&quot;)&quot;
    </font><font color="#008000"><b><i>'extract the function name, for example &quot;Sin&quot;
</i></b>    </font>function <font color="#000080">= </font><font color="#0000FF">LTRIM$</font><font color="#000080">(</font><font color="#0000FF">LEFT$</font><font color="#000080">(</font>expr<font color="#000080">, </font>pos<font color="#000080">-</font><b>1</b><font color="#000080">))
    
    </font><font color="#008000"><b><i>'extract the expression inside the parentheses, &quot;2+3&quot;
</i></b>    <b><i>'evaluate this expression
</i></b>    </font>part2 <font color="#000080">= </font><font color="#0000FF">MID$</font><font color="#000080">(</font>expr<font color="#000080">, </font>pos<font color="#000080">+</font><b>1</b><font color="#000080">, </font><font color="#0000FF">LEN</font><font color="#000080">(</font>expr<font color="#000080">)-</font>pos<font color="#000080">-</font><b>1</b><font color="#000080">)
    </font>value2 <font color="#000080">= </font>Eval<font color="#000080">(</font>part2<font color="#000080">, </font>msg<font color="#000080">)
    
    </font><font color="#008000"><b><i>'evaluate the function
</i></b>    </font><font color="#0000FF">SELECT UCASE$</font><font color="#000080">(</font>function<font color="#000080">)
        </font><font color="#008000"><b><i>'if function=&quot;&quot;, then the expression is just enclosed
</i></b>        <b><i>'with brackets, like &quot;(2+3*4)&quot;
</i></b>        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;&quot;     </font><font color="#000080">:</font><font color="#0000FF">RETURN </font>value2
            
        <font color="#008000"><b><i>'arithmetic functions
</i></b>        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;ABS&quot;  </font><font color="#000080">:</font><font color="#0000FF">RETURN ABS</font><font color="#000080">(</font>value2<font color="#000080">)
        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;SQRT&quot; </font><font color="#000080">:</font><font color="#0000FF">RETURN SQRT</font><font color="#000080">(</font>value2<font color="#000080">)
        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;LOG&quot;  </font><font color="#000080">:</font><font color="#0000FF">RETURN LOG</font><font color="#000080">(</font>value2<font color="#000080">)
        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;LOG10&quot;</font><font color="#000080">:</font><font color="#0000FF">RETURN LOG10</font><font color="#000080">(</font>value2<font color="#000080">)
        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;EXP&quot;  </font><font color="#000080">:</font><font color="#0000FF">RETURN EXP</font><font color="#000080">(</font>value2<font color="#000080">)
        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;INT&quot;  </font><font color="#000080">:</font><font color="#0000FF">RETURN INT</font><font color="#000080">(</font>value2<font color="#000080">)
        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;CEIL&quot; </font><font color="#000080">:</font><font color="#0000FF">RETURN CEIL</font><font color="#000080">(</font>value2<font color="#000080">)
        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;FLOOR&quot;</font><font color="#000080">:</font><font color="#0000FF">RETURN FLOOR</font><font color="#000080">(</font>value2<font color="#000080">)

        </font><font color="#008000"><b><i>'Trigonometric functions
</i></b>        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;SIN&quot;  </font><font color="#000080">:</font><font color="#0000FF">RETURN SIN</font><font color="#000080">(</font>value2<font color="#000080">)
        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;COS&quot;  </font><font color="#000080">:</font><font color="#0000FF">RETURN COS</font><font color="#000080">(</font>value2<font color="#000080">)
        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;TAN&quot;  </font><font color="#000080">:</font><font color="#0000FF">RETURN TAN</font><font color="#000080">(</font>value2<font color="#000080">)
        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;ASIN&quot; </font><font color="#000080">:</font><font color="#0000FF">RETURN ASIN</font><font color="#000080">(</font>value2<font color="#000080">)
        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;ACOS&quot; </font><font color="#000080">:</font><font color="#0000FF">RETURN ACOS</font><font color="#000080">(</font>value2<font color="#000080">)
        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;ATAN&quot; </font><font color="#000080">:</font><font color="#0000FF">RETURN ATAN</font><font color="#000080">(</font>value2<font color="#000080">)
            
        </font><font color="#008000"><b><i>'Hyperbolic functions
</i></b>        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;SINH&quot; </font><font color="#000080">:</font><font color="#0000FF">RETURN SINH</font><font color="#000080">(</font>value2<font color="#000080">)
        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;COSH&quot; </font><font color="#000080">:</font><font color="#0000FF">RETURN COSH</font><font color="#000080">(</font>value2<font color="#000080">)
        </font><font color="#0000FF">CASE </font><font color="#800080">&quot;TANH&quot; </font><font color="#000080">:</font><font color="#0000FF">RETURN TANH</font><font color="#000080">(</font>value2<font color="#000080">)
            
        </font><font color="#008000"><b><i>'Unknown function
</i></b>        </font><font color="#0000FF">DEFAULT     </font><font color="#000080">:</font>errSet<font color="#000080">(</font>msg<font color="#000080">, </font>MSG_DOMAINERROR<font color="#000080">, </font><font color="#800080">&quot;Error: Unknown function \&quot;&quot; + function + &quot;</font><font color="#000080">\</font><font color="#800080">&quot;&quot;</font><font color="#000080">)
    </font><font color="#0000FF">ENDSELECT
ENDIF
</font></font>
</code></pre>
</body>
</html>