<html>
<head>
<title>instrP.iba</title>
</head>
<!-- Generated by SynEdit HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  size="3" face="Courier New"><font color="#0000FF">SUB </font>instrP<font color="#000080">(</font>source<font color="#000080">:</font><font color="#FF0000">STRING</font><font color="#000080">, </font>search<font color="#000080">:</font><font color="#FF0000">STRING</font><font color="#000080">, </font>start<font color="#000080">:</font><font color="#FF0000">INT</font><font color="#000080">), </font><font color="#FF0000">INT
    </font><font color="#008000"><b><i>'this sub searches for the LAST string search in the string
</i></b>    <b><i>'source, reverse of the function instr(). The sub returns 0 if
</i></b>    <b><i>'the search could not be found. Also this function neglects
</i></b>    <b><i>'content between parenthesis () in source
</i></b>    </font><font color="#FF0000">INT </font>n<font color="#000080">, </font>bopen<font color="#000080">, </font>bclose
    <font color="#FF0000">STRING </font>sign
    
    n<font color="#000080">=</font>start
    <font color="#0000FF">IF </font>n<font color="#000080">&gt;</font><font color="#0000FF">LEN</font><font color="#000080">(</font>source<font color="#000080">) </font><font color="#0000FF">THEN </font>n<font color="#000080">=</font><font color="#0000FF">LEN</font><font color="#000080">(</font>source<font color="#000080">)-</font><font color="#0000FF">LEN</font><font color="#000080">(</font>search<font color="#000080">)+</font><b>1
</b>    bopen<font color="#000080">=</font><b>0</b>     <font color="#000080">:</font><font color="#008000"><b><i>'number of parenthesis open (
</i></b>    </font>bclose<font color="#000080">=</font><b>0</b>    <font color="#000080">:</font><font color="#008000"><b><i>'number of parenthesis close )
</i></b>    </font><font color="#0000FF">DO
        </font>sign <font color="#000080">= </font><font color="#0000FF">MID$</font><font color="#000080">(</font>source<font color="#000080">, </font>n<font color="#000080">, </font><font color="#0000FF">LEN</font><font color="#000080">(</font>search<font color="#000080">))
        </font><font color="#008000"><b><i>'if search is found and outside parentheses then return n
</i></b>        </font><font color="#0000FF">IF </font><font color="#000080">(</font>sign<font color="#000080">=</font>search<font color="#000080">) </font><font color="#0000FF">AND </font><font color="#000080">(</font>bopen<font color="#000080">=</font>bclose<font color="#000080">) </font><font color="#0000FF">THEN RETURN </font>n
        <font color="#0000FF">IF LEFT$</font><font color="#000080">(</font>sign<font color="#000080">,</font><b>1</b><font color="#000080">)=</font><font color="#800080">&quot;(&quot; </font><font color="#0000FF">THEN </font>bopen<font color="#000080">++
        </font><font color="#0000FF">IF LEFT$</font><font color="#000080">(</font>sign<font color="#000080">,</font><b>1</b><font color="#000080">)=</font><font color="#800080">&quot;)&quot; </font><font color="#0000FF">THEN </font>bclose<font color="#000080">++
        </font>n<font color="#000080">--
    </font><font color="#0000FF">UNTIL </font><font color="#000080">(</font>n <font color="#000080">&lt;= </font><b>0</b><font color="#000080">)
    
    </font><font color="#008000"><b><i>'if the string search is not found, then return 0
</i></b>    </font><font color="#0000FF">RETURN </font><b>0
</b><font color="#0000FF">ENDSUB
</font></font>
</code></pre>
</body>
</html>